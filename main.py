from eval import result


def main():
    # Read data
    with open('data/example5.txt', 'r') as f:
        N ,K = tuple(map(int, f.readline().split()))
        cost_matrix = []
        for _ in range(2*N + 1):
            cost_matrix.append(tuple(map(int, f.readline().split())))

    # Test
    # route = '3 13 43 50 65 92 45 97 113 145 34 30 6 62 130 9 5 79 20 22 99 24 53 179 47 57 60 4 27 197 72 10 46 162 19 23 38 8 71 12 33 77 14 103 123 41 96 21 36 147 17 28 122 160 37 1 32 78 121 40 101 42 128 58 90 75 84 44 171 11 119 48 178 81 141 61 146 59 158 190 54 175 82 117 154 108 177 153 157 140 39 74 133 98 127 134 148 80 94 25 70 26 15 31 35 52 172 67 106 100 135 55 120 68 110 7 136 18 105 112 174 29 69 126 132 165 192 199 73 88 83 107 125 2 64 86 87 93 115 129 138 131 173 49 95 144 143 194 155 182 183 184 56 66 111 150 16 63 104 166 51 163 89 91 109 164 142 191 102 200 187 167 195 170 198 180 116 169 181 139 149 85 114 156 196 159 137 124 161 193 186 189 76 152 176 185 151 188 118 168'
    route = '740 554 392 949 681 27 876 213 454 5 718 549 55 56 46 779 504 683 71 715 806 467 902 589 882 175 828 918 1392 401 202 722 836 723 916 1467 91 14 376 126 417 552 66 345 1091 864 1005 292 1549 666 1683 728 1723 119 1779 33 1014 72 1292 156 1681 528 1504 34 1055 1740 544 866 1722 631 1866 603 1603 227 1034 424 1902 981 1589 861 1056 103 1126 192 1454 414 1033 236 1631 7 1071 42 1918 39 1666 111 1156 90 1042 346 1544 259 1876 705 1705 288 1718 796 1728 69 1202 64 1864 246 1417 70 1259 523 1554 233 1345 105 1213 672 1376 456 1069 210 1227 174 1090 49 1949 588 1236 157 1401 95 1552 108 1175 87 1072 80 1049 282 1528 538 1039 107 1233 894 1861 966 1796 160 1160 387 1103 155 1282 118 1456 626 1523 161 1155 391 1070 801 1801 81 1027 691 1174 446 1161 371 1981 20 1538 355 1119 303 1806 460 1108 591 1460 339 1303 294 1355 712 1346 752 1966 221 1246 316 1107 874 1007 488 1118 75 1105 958 1288 867 1867 291 1424 44 1020 703 1080 28 1371 147 1691 418 1339 63 1836 895 1111 113 1046 229 1192 267 1715 839 1095 1588 403 293 1894 234 1316 379 1221 542 1672 887 1081 466 1874 240 1828 61 1916 163 1294 364 1414 16 1488 106 1703 360 1066 853 1387 305 1240 162 1210 183 1882 135 1853 997 1466 754 1839 177 1958 21 1064 323 1712 88 1293 701 1016 611 1611 4 1229 776 1701 402 1234 491 1147 158 1997 520 1267 328 1028 2 1113 270 1063 416 1542 186 1177 937 1305 619 1088 130 1021 6 1044 114 1157 23 1379 102 1087 653 1626 438 1004 164 1061 231 1360 605 1158 685 1164 498 1685 191 1270 535 1776 594 1183 775 1498 150 1364 571 1491 651 1653 241 1403 519 1323 739 1402 13 1438 173 1163 375 1013 590 1328 170 1231 19 1590 489 1241 618 1170 1173 396 99 1396 369 1489 137 1775 400 1651 30 1137 24 1618 384 1739 536 1102 178 1895 287 1106 408 1887 342 1024 426 1287 614 1291 564 1375 48 1002 1342 410 1114 404 527 1564 153 1410 296 1418 395 1754 35 1130 393 1006 96 1162 57 1605 493 1023 336 1393 405 1191 1752 1446 940 942 1391 635 50 1619 648 1336 148 1019 8 1148 642 1493 768 1296 300 1519 230 1178 551 1520 197 1408 146 1571 693 1150 98 1030 217 1098 121 1404 819 1527 263 1940 117 1416 269 1263 299 1217 349 1535 484 1400 322 1594 686 1937 144 1648 733 1269 83 1635 485 1693 41 1642 167 1369 833 1384 1614 480 1395 892 934 1686 802 1551 550 1167 727 1050 857 1300 645 1048 283 1349 598 1083 969 1153 663 1146 624 1833 128 1144 743 1727 433 1645 351 1230 668 1550 548 1548 196 1299 367 1283 368 1096 169 1117 492 1368 851 1743 991 1934 145 1991 330 1330 777 1169 688 1802 93 1367 859 1351 214 1186 168 1196 124 1168 275 1433 79 1079 952 1492 116 1688 566 1116 180 1275 260 1121 1322 818 749 1485 412 1952 474 1768 228 1598 481 1075 788 1591 216 1135 797 1942 494 1788 704 1228 94 1797 1481 115 741 1741 897 1094 510 1897 329 1329 218 1115 52 1474 365 1749 172 1260 422 1093 518 1035 791 1624 125 1172 730 1484 84 1216 898 1124 307 1851 333 1405 716 1536 432 1432 899 1510 499 1197 903 1426 100 1730 212 1052 60 1859 273 1099 266 1180 38 1008 567 1266 237 1567 140 1668 223 1857 865 1223 771 1494 622 1892 506 1777 515 1041 423 1733 708 1566 201 1663 272 1791 310 1819 1969 225 82 1218 62 1145 901 1704 420 1084 539 1212 1480 461 462 1214 860 1818 950 1412 279 1860 604 1225 74 1038 262 1310 745 1898 719 1865 207 1307 469 1899 529 1622 979 1708 888 1423 247 1420 490 1462 131 1515 36 1365 627 1490 449 1237 692 1060 746 1333 86 1903 807 1604 92 1262 1518 976 133 1128 68 1506 913 1082 561 1201 453 1913 547 1125 317 1131 101 1100 1422 1771 254 15 846 1539 875 1074 975 1499 717 1719 18 1133 659 1015 572 1572 793 1875 289 1068 684 1888 602 1317 255 1255 670 1018 362 1529 211 1254 558 1207 633 1975 577 1979 1461 141 543 1247 928 1627 607 1036 625 1901 982 1086 428 1449 634 1746 127 1547 419 1558 1561 304 537 1684 302 1670 601 1692 840 1840 439 1127 479 1289 726 1439 256 1726 640 1745 335 1950 661 1062 576 1576 209 1362 222 1092 313 1479 220 1279 194 1846 181 1313 963 1469 226 1057 199 1140 77 1273 129 1453 714 1101 290 1716 750 1634 478 1661 678 1419 649 1290 869 1601 847 1928 858 1633 243 1577 638 1211 332 1659 831 1976 58 1222 455 1209 921 1077 159 1678 794 1638 526 1794 65 1159 350 1302 999 1640 427 1607 985 1526 442 1226 475 1807 545 1869 732 1847 778 1243 242 1332 669 1478 132 1732 314 1442 3 1625 924 1199 522 1831 556 1649 970 1602 1256 575 311 1924 891 1141 978 1921 327 1858 1 1242 1132 1455 53 927 1556 617 862 1350 366 1714 606 1181 1311 890 917 1982 244 1575 804 1862 758 1427 1917 559 904 1750 682 1793 151 1522 541 1606 737 1304 176 1065 919 1220 465 1717 821 1541 112 1327 252 1151 239 1559 205 1758 51 1205 936 1475 308 1919 297 1669 900 1904 798 1927 450 1617 142 1821 799 1244 770 1537 646 1985 189 1003 959 1999 540 1272 343 1058 315 1737 309 1314 452 1890 505 1252 388 1963 525 1770 200 1112 699 1699 89 1545 893 1200 486 1366 261 1051 947 1778 472 1900 654 1525 945 1194 623 1540 621 1176 655 1239 596 1646 835 1596 232 1655 713 1465 251 1251 674 1297 235 1623 690 1505 764 1893 665 1945 843 1970 883 1450 203 1343 805 1891 11 1621 264 1674 47 1798 1053 879 599 1682 248 1543 43 1335 514 1764 382 1978 301 1315 587 1301 386 1799 511 1472 808 1001 406 1189 399 1514 206 1511 507 1399 531 1452 25 1203 826 1264 394 1713 849 1043 500 1261 926 1959 109 1394 473 1142 1428 1129 886 1599 760 516 1760 97 790 1826 731 1879 912 1926 470 1047 748 1516 873 1886 988 1470 9 1808 694 1009 381 1531 1206 1804 1089 1947 1473 1232 1912 767 370 695 724 784 710 762 448 1665 1762 1835 110 249 1936 1654 1110 998 530 1308 774 825 445 1109 987 1248 517 1694 783 1507 854 1805 398 1500 440 1790 208 1784 597 1988 677 1710 521 1448 1235 996 359 1249 271 1386 195 1382 763 1843 1370 967 756 1440 863 1748 628 1398 757 1873 647 1854 204 1486 772 1309 59 1849 780 1724 615 1359 658 1825 358 1757 441 1767 803 1763 546 1628 676 1011 812 1388 841 1517 280 1530 1677 495 219 1358 643 1756 960 1960 595 1731 968 1195 592 1546 636 1987 700 1690 1841 152 734 1998 939 1783 1097 1381 497 972 842 1219 922 1615 641 1695 533 1780 502 1996 962 1597 1025 632 974 1441 165 1595 276 1502 435 1587 822 1280 977 1208 383 1883 944 1383 415 1803 347 1676 578 1415 914 1347 1533 361 457 1152 122 1361 1842 268 931 1497 143 1914 285 1931 312 1772 907 1636 1939 1521 436 789 973 1643 1495 1700 215 306 871 1973 787 1734 1944 380 1967 759 123 1271 920 1774 870 1435 1863 1759 569 954 1922 1968 990 245 698 1658 837 1569 673 1306 238 1972 508 1977 725 1285 1276 735 171 1592 742 1822 483 1059 10 1962 281 1123 951 1436 964 1647 585 1812 906 1268 1641 1457 1632 629 946 993 935 1245 338 1508 755 1171 31 1906 850 1974 425 1787 1951 78 782 1907 953 1725 925 1954 844 1010 911 1204 374 1338 73 1925 580 1789 496 1698 786 1837 832 1585 413 1425 407 1782 667 1870 373 1143 139 1281 250 1935 257 1406 464 1911 190 1238 524 1578 834 1312 295 1580 609 1257 809 1844 915 1755 1464 671 17 1407 583 1139 679 1524 933 1915 377 1377 154 1809 885 1073 1496 1295 1953 1445 1122 1673 1832 1190 994 258 501 1994 1946 680 356 855 340 40 352 509 753 1031 503 1920 736 1990 29 1629 451 1667 838 1786 341 1501 896 1735 1871 570 751 1413 600 1679 823 1742 868 1380 689 1964 1680 1017 1736 389 437 1993 905 1834 138 908 955 1671 956 1850 579 1751 644 1600 881 1258 702 1689 1868 553 983 1702 613 1881 848 1855 616 1374 817 1644 179 1908 198 1356 696 1341 765 1340 1000 1165 443 1753 1154 1696 1553 810 943 948 188 1443 431 1431 32 1029 1570 1215 1250 563 421 573 136 1509 85 1823 1765 2000 1421 1451 1503 1198 1616 1078 1885 965 37 1609 816 584 744 989 463 1573 565 334 721 845 385 1483 54 1373 971 1040 434 1352 325 1389 1584 961 274 1905 372 1838 284 1284 1816 1325 1721 1274 67 929 652 512 1565 711 348 1348 187 1848 568 1711 992 1971 326 1334 872 1929 707 1187 430 1463 321 1032 1948 184 814 1845 795 1434 1568 1136 1810 1512 1814 1872 1372 1179 534 45 76 612 995 773 637 889 253 1773 664 1707 182 1795 1326 1612 1184 166 353 813 815 1965 1813 697 657 1657 149 1037 630 1961 557 1557 877 1054 639 1385 574 1877 660 1583 1579 1166 1652 1430 337 320 852 363 769 1045 12 1182 120 1637 820 1660 22 1320 909 1909 1188 1012 1574 1664 1534 1563 1995 1744 1022 1896 1076 1437 1955 397 378 1149 811 1138 582 829 482 344 324 709 729 1613 706 185 827 1253 1992 1353 1815 1363 1956 1943 1067 656 444 555 593 134 562 884 785 581 620 26 687 1397 856 1444 720 1321 1697 1337 1582 1185 1555 1827 1593 1769 458 1378 513 471 193 277 1829 1026 1656 1729 1482 941 766 1766 1324 938 747 932 286 331 923 298 738 761 224 1923 986 1932 1747 1193 1761 1513 319 1224 980 357 278 390 265 1986 586 1933 1852 781 1390 409 675 1817 429 1639 104 1785 1738 1581 1675 1357 1562 1586 1687 1458 1134 1884 1709 1889 1720 1277 1706 1938 1298 1409 1331 1620 1820 830 1941 459 487 910 354 800 447 318 1085 1471 878 560 662 532 411 957 880 476 1630 1989 1983 1286 1354 1662 1429 1344 1856 1532 1476 824 1120 1811 1278 1319 1824 1880 1265 1459 1560 608 468 1781 930 650 610 984 477 1477 1980 1910 1104 1957 1930 1830 1608 1878 1487 1984 1411 1610 1650 1800 1447 792 1318 1792 1468'
    res = result(N, K, cost_matrix, route)
    print(res.route_cost())
    print(res.precedence_test())
    print(res.capacity_test())


if __name__ == '__main__':
    main()